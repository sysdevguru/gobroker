package main

import (
	"fmt"

	"github.com/alpacahq/gobroker/models"
	"github.com/gocarina/gocsv"
)

func main() {
	s := []models.DayPLSnapshot{}

	err := gocsv.UnmarshalString(snaps, &s)
	if err != nil {
		panic(err)
	}

	for i := 1; i < len(snaps); i++ {
		s1 := s[i-1]
		s2 := s[i]

		fmt.Printf("[%v] discrepancy: %v\n", s1.ID, s1.Basis.Add(s1.ProfitLoss).Sub(s2.Basis))
	}
}

var snaps = `id,created_at,account_id,profit_loss,basis,date
350,2018-06-11 17:15:50.716416+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,1.9464,500,2018-05-18
355,2018-06-11 17:15:52.070897+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-7.7494,501.945,2018-05-21
360,2018-06-11 17:15:53.467662+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,32.4803,494.19,2018-05-22
365,2018-06-11 17:15:54.778818+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-27.6795,526.67,2018-05-23
370,2018-06-11 17:15:57.212927+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-5.2683,498.99,2018-05-24
375,2018-06-11 17:15:58.472146+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-8.98,493.72,2018-05-25
380,2018-06-11 17:15:59.986724+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-14.6,484.74,2018-05-29
385,2018-06-11 17:16:01.338176+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,19.9311,470.14,2018-05-30
390,2018-06-11 17:16:02.544495+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-5.22,490.07,2018-05-31
395,2018-06-11 17:16:03.865151+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,5.3506,484.85,2018-06-01
400,2018-06-11 17:16:04.731799+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,17.09,485.2,2018-06-04
405,2018-06-11 17:16:05.708809+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-15.51,502.29,2018-06-05
425,2018-06-11 23:07:51.6099+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-11.32,486.78,2018-06-06
430,2018-06-11 23:07:52.084661+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-20.0865,475.46,2018-06-07
435,2018-06-11 23:07:52.394908+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,15.798,455.372,2018-06-08
439,2018-06-12 11:16:47.609719+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-0.18,471.17,2018-06-11
443,2018-06-13 11:17:07.87194+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,2.3246,470.99,2018-06-12
448,2018-06-14 11:20:40.71421+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-10.454,473.314,2018-06-13
452,2018-06-15 11:17:54.625805+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,16.7,462.86,2018-06-14
459,2018-06-16 11:17:47.525851+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,16.8416,479.56,2018-06-15
463,2018-06-19 11:17:32.843635+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,0.01,496.4,2018-06-18
472,2018-06-20 11:17:10.5252+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,10.82,496.41,2018-06-19
477,2018-06-21 11:18:06.268436+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-5.91,507.23,2018-06-20
485,2018-06-22 11:18:56.286076+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-5.36,501.32,2018-06-21
491,2018-06-25 18:37:03.332082+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,4.74,495.96,2018-06-22
502,2018-06-26 22:00:49.269542+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-4.91,500.7,2018-06-25
505,2018-06-27 14:45:47.034281+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-0.68,495.79,2018-06-26
515,2018-06-28 13:32:42.948539+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-11.8,495.11,2018-06-27
521,2018-06-29 14:59:08.720098+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,5.71,483.31,2018-06-28
530,2018-06-30 14:26:08.744789+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-1.6192,489.38,2018-06-29
541,2018-07-03 11:01:31.410117+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-7.2495,487.76,2018-07-02
552,2018-07-04 11:01:44.101134+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,4.77,480.51,2018-07-03
559,2018-07-06 11:01:47.069649+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-3.23,485.28,2018-07-05
563,2018-07-07 11:01:28.199387+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,9.011,482.08,2018-07-06
571,2018-07-10 11:07:14.230922+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,23.3485,491.09,2018-07-09
582,2018-07-11 11:01:33.920902+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-3.7374,514.438,2018-07-10
592,2018-07-12 11:01:29.960967+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-15.17,510.7,2018-07-11
604,2018-07-13 11:01:36.618297+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,2.42,495.53,2018-07-12
611,2018-07-14 11:01:56.660656+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,7.36,497.95,2018-07-13
622,2018-07-17 11:02:22.879394+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-4.77,505.31,2018-07-16
637,2018-07-18 11:01:27.359798+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,14.7415,500.54,2018-07-17
647,2018-07-19 11:01:25.154971+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-4.56,515.28,2018-07-18
662,2018-07-20 11:01:27.120875+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,1.29,510.72,2018-07-19
680,2018-07-21 11:01:21.936993+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,9.7114,512.01,2018-07-20
694,2018-07-24 11:01:25.330449+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,6.2504,521.72,2018-07-23
716,2018-07-25 11:01:23.618827+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,7.2955,527.97,2018-07-24
732,2018-07-26 11:01:28.610763+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,16.86,535.71,2018-07-25
749,2018-07-27 11:01:22.027901+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-16.04,552.57,2018-07-26
768,2018-07-28 11:01:23.550231+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,12.1665,536.53,2018-07-27
786,2018-07-31 11:01:24.452014+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,1.4505,548.69,2018-07-30
797,2018-08-01 11:06:40.837852+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-5.6796,550.14,2018-07-31
827,2018-08-02 11:01:25.070149+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-2.47,544.46,2018-08-01
838,2018-08-03 11:01:21.028219+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,1.9514,541.99,2018-08-02
865,2018-08-04 11:01:19.52561+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,19.9405,543.94,2018-08-03
888,2018-08-07 11:01:18.343977+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-7.12,563.88,2018-08-06
910,2018-08-08 11:01:18.103638+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-14.9895,556.76,2018-08-07
924,2018-08-09 11:01:18.978403+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-2.09,541.77,2018-08-08
956,2018-08-10 11:01:18.424095+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-6.6095,539.68,2018-08-09
977,2018-08-11 11:01:15.47283+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-26.46,533.07,2018-08-10
996,2018-08-14 13:26:11.540572+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,4.04,506.61,2018-08-13
1018,2018-08-15 13:22:23.37651+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,2.77,510.65,2018-08-14
1042,2018-08-16 13:14:19.729458+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-8.67,513.42,2018-08-15
1061,2018-08-17 11:01:32.928386+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-4.4,504.75,2018-08-16
1086,2018-08-18 11:01:30.830601+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-1.22,500.35,2018-08-17
1099,2018-08-21 11:01:32.568745+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,4.54,499.13,2018-08-20
1131,2018-08-22 11:01:32.636867+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-4.62,503.67,2018-08-21
1147,2018-08-23 11:01:34.878999+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,13.95,499.05,2018-08-22
1165,2018-08-24 11:01:32.425032+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-15.19,513,2018-08-23
1189,2018-08-25 11:01:32.976645+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,8.43,497.81,2018-08-24
1212,2018-08-28 11:01:32.172383+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,21.79,506.24,2018-08-27
1242,2018-08-29 11:01:31.751093+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-5.69,528.03,2018-08-28
1266,2018-08-30 11:01:32.470287+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,11.3,522.34,2018-08-29
1292,2018-08-31 11:01:33.940462+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-10.11,533.64,2018-08-30
1320,2018-09-01 11:01:31.942117+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,11.02,523.53,2018-08-31
1354,2018-09-05 11:01:34.117251+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-19.21,534.55,2018-09-04
1375,2018-09-06 11:01:31.862713+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-4.26,515.34,2018-09-05
1407,2018-09-07 11:01:32.04251+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-2.2,511.08,2018-09-06
1436,2018-09-08 11:01:32.979501+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,3.46,508.88,2018-09-07
1454,2018-09-11 11:01:34.762896+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-1.46,512.34,2018-09-10
1482,2018-09-12 11:01:33.642102+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-5.88,504.29,2018-09-11
1516,2018-09-13 11:01:38.48414+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,12.34,498.41,2018-09-12
1549,2018-09-14 11:01:35.448876+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-5.7,510.75,2018-09-13
1570,2018-09-15 11:01:31.251226+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-1.5,505.05,2018-09-14
1605,2018-09-18 11:01:30.91412+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,0.01,503.55,2018-09-17
1632,2018-09-19 11:01:34.798854+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,12.97,503.56,2018-09-18
1668,2018-09-20 11:01:31.463632+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,3.44,516.53,2018-09-19
1703,2018-09-21 11:01:39.530993+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-1.7,519.97,2018-09-20
1734,2018-09-22 11:01:37.195283+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,8.07,518.27,2018-09-21
1765,2018-09-25 11:01:34.661016+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,4.78,526.34,2018-09-24
1805,2018-09-26 11:01:37.540842+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,5.86,531.12,2018-09-25
1837,2018-09-27 11:01:37.805808+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,0.63,536.98,2018-09-26
1887,2018-09-28 11:01:39.301652+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,12.3,537.61,2018-09-27
1918,2018-09-29 11:01:38.712171+00,e05e75cf-d99c-47dc-a1b2-89f0b340cbdb,-3.7,549.91,2018-09-28`
